/*
* =====================================================================================
 *
 *       Filename:  lambda.h
 *
 *    Description:  Idiomatic C99 interface to interact with Lambda
 *
 *        Version:  0.0.1
 *        Created:  2025-04-12 17:14:01
 *       Compiler:  clang
 *
 *         Author:  Emy ðŸ’œ (https://emy.systems),
 *
 * =====================================================================================
 */

#ifndef LAMBDA_H
#define LAMBDA_H

#define SIG_INT       "I"
#define SIG_BOOLEAN   "Z"
#define SIG_BYTE      "B"
#define SIG_CHAR      "C"
#define SIG_SHORT     "S"
#define SIG_LONG      "J"
#define SIG_FLOAT     "F"
#define SIG_DOUBLE    "D"
#define SIG_VOID      "V"

#define SIG_CLASS(name)  "L" name ";"
#define SIG_ARRAY(type) "[" type
#define SIG_FUNC(ret, ...)  "(" __VA_ARGS__ ")" ret

#define ARRAY_LEN(arr) (sizeof(arr) / sizeof(arr[0]))

#include <stdlib.h>
#include <jvmti.h>
#include <jni.h>
#include <stdint.h>

typedef struct {
    jclass      super_klass;
    jclass      klass;
    jobject     instance;

    jmethodID   listen;
    jmethodID   listen_k;
    jmethodID   listen_once;
    jmethodID   listen_concurrently;
} listener_companion;

typedef struct {
    jclass      super_klass;
    jclass      klass;
    jobject     instance;

    jmethodID   listen_unsafe;
    jmethodID   listen_once_unsafe;
    jmethodID   listen_concurrently_unsafe;
} unsafe_listener_companion;

typedef struct {
    jclass      klass;
    jobject     instance;

    jmethodID   version;
    jmethodID   log;
    jmethodID   mc; // static
    jmethodID   is_debug;
} lambda;

typedef struct
{
    jclass      klass;

    jmethodID   new_proxy_instance;
} proxy;

typedef struct
{
    jclass      klass;

    jmethodID   get_kotlin_class;
} kotlin_reflection;

typedef void* (listen_lambda)(void*, void*); // SafeContext.(T) -> Unit

typedef struct
{
    jclass  klass;
    jobject instance;
} event;

kotlin_reflection*
    get_kotlin_reflection(JNIEnv *env);

event*
    get_event(jvmtiEnv *jvmti, JNIEnv *env, const char *name);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_listener_companion
 *  Description:    Returns a struct containing the methods of SafeListener's companion.
 *                  The instance of the companion is stored in listener_companion_instance.
 * =====================================================================================
 */
listener_companion*
    get_listener_companion(
        jvmtiEnv    *jvmti,
        JNIEnv      *env);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    listener_companion_listen
 *  Description:    Returns a struct containing the methods of SafeListener's companion.
 *                  The instance of the companion is stored in listener_companion_instance.
 * =====================================================================================
 */
void
    listener_companion_listen(
        jvmtiEnv            *jvmti,
        JNIEnv              *env,
        listener_companion  *companion,
        jobject             owner,
        int32_t             priority,
        jboolean            alwaysListen,
        listen_lambda       lambda);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_unsafe_listener_companion
 *  Description:    Returns a struct containing the methods of UnsafeListener's companion
 *                  The instance of the companion is stored in unsafe_listener_companion_instance.
 * =====================================================================================
 */
unsafe_listener_companion*
    get_unsafe_listener_companion(
        jvmtiEnv    *jvmti,
        JNIEnv      *env);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_lambda
 *  Description:    Returns a struct containing the class and methods of java.lang.reflect.Proxy
 *                  You must free the pointer when you are done with the struct.
 * =====================================================================================
 */
proxy*
    get_proxy(JNIEnv *env);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_lambda
 *  Description:    Returns a struct containing the class and methods of com.lambda.Lambda
 *                  You must free the pointer when you are done with the struct.
 * =====================================================================================
 */
const lambda*
    get_lambda(
        jvmtiEnv    *jvmti,
        JNIEnv      *env);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    lambda_version
 *  Description:    Returns a copied utf8 jstring of the mod's version.
 *                  Must be freed with ReleaseStringChars.
 * =====================================================================================
 */
const char*
    lambda_version(
        JNIEnv          *env,
        const lambda    *lambda);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    lambda_log
 *  Description:    Returns the Log4j class instance of Lambda.
 * =====================================================================================
 */
jobject
    lambda_log(
        JNIEnv          *env,
        const lambda    *lambda);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    lambda_mc
 *  Description:    Returns the MinecraftClient class instance.
 * =====================================================================================
 */
void*
    lambda_mc(
        JNIEnv          *env,
        const lambda    *lambda);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    lambda_is_debug
 *  Description:    Returns whether the mod is running in the development environment.
 * =====================================================================================
 */
jboolean
    lambda_is_debug(
        JNIEnv          *env,
        const lambda    *lambda);

/*
 * ====================================================================================
 * ====================================================================================
 * ====================================================================================
 */

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_class
 *  Description:    Finds a class by its name
 * =====================================================================================
 */
jclass
    get_class(
        JNIEnv      *env,
        const char  *name);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_sclass
 *  Description:
 * =====================================================================================
 */
jobject
    get_sclass(
        jvmtiEnv  *jvmti,
        JNIEnv    *env,
        jclass    klass);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    get_cclass
 *  Description:    Finds a class companion and returns its Companion instance.
 *                  The class signature must be of the parent class.
 * =====================================================================================
 */
jobject
    get_cclass(
        jvmtiEnv    *jvmti,
        JNIEnv      *env,
        jclass      super_klass,
        jclass      klass);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    has_method
 *  Description:    Returns whether the given class contains the method name with its signature
 * =====================================================================================
 */
jboolean
    has_method(
        jvmtiEnv    *jvmti,
        jclass      klass,
        const char  *name,
        const char  *sig);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    has_field
 *  Description:    Returns whether the given class contains the field name and its signature
 * =====================================================================================
 */
jboolean
    has_field(
        jvmtiEnv    *jvmti,
        jclass      klass,
        const char  *name,
        const char  *sig);

/*
 * ===  FUNCTION  ======================================================================
 *         Name:    lambdah_init
 *  Description:   Initializes various components for the interface.
 * =====================================================================================
 */
void
    lambdah_init(
        jvmtiEnv    *jvmti,
        JNIEnv      *env);

JNIEXPORT
jobject
JNICALL
  Java_com_lambda_Function2Native_invokeNative(
      JNIEnv    *env,
      jobject   p1,
      jobject   p2);

#ifndef LAMBDA_IMPL
#define LAMBDA_IMPL

#include <assert.h>
#include <string.h>

inline
listener_companion*
    get_listener_companion(
        jvmtiEnv            *jvmti,
        JNIEnv              *env)
{
    listener_companion *companion = malloc(sizeof(listener_companion));

    companion->super_klass          = (*env)->FindClass(env, "com/lambda/event/listener/SafeListener");
    companion->klass                = (*env)->FindClass(env, "com/lambda/event/listener/SafeListener$Companion");
    companion->instance             = get_cclass(jvmti, env, companion->super_klass, companion->klass);
    companion->listen               = (*env)->GetMethodID(env, companion->klass, "listen", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlin/jvm/functions/Function2")));
    companion->listen_k             = (*env)->GetMethodID(env, companion->klass, "listen", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_CLASS("kotlin/reflect/KClass") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlin/jvm/functions/Function2")));
    //companion->listen_once          = (*env)->GetMethodID(env, companion->klass, "listenOnce", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlin/jvm/functions/Function2")));
    //companion->listen_concurrently  = (*env)->GetMethodID(env, companion->klass, "listenConcurrently", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlinx/coroutines/CoroutineDispatcher") SIG_CLASS("kotlin/jvm/functions/Function2")));

    return companion;
}

inline
void
    listener_companion_listen(
        jvmtiEnv            *jvmti,
        JNIEnv              *env,
        listener_companion *companion,
        jobject             owner,
        int32_t             priority,
        jboolean            alwaysListen,
        listen_lambda       lambda)
{

}

inline
unsafe_listener_companion*
    get_unsafe_listener_companion(
        jvmtiEnv    *jvmti,
        JNIEnv      *env)
{
    unsafe_listener_companion *companion = malloc(sizeof(unsafe_listener_companion));

    companion->super_klass          = (*env)->FindClass(env, "com/lambda/event/listener/UnsafeListener");
    companion->klass                = (*env)->FindClass(env, "com/lambda/event/listener/UnsafeListener$Companion");
    companion->instance             = get_cclass(jvmti, env, companion->super_klass, companion->klass);
    companion->listen_unsafe        = (*env)->GetMethodID(env, companion->klass, "listenUnsafe", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlin/jvm/functions/Function1")));
    companion->listen_once_unsafe   = (*env)->GetMethodID(env, companion->klass, "listenOnceUnsafe", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlin/jvm/functions/Function1")));
    companion->listen_concurrently_unsafe =
        (*env)->GetMethodID(env, companion->klass, "listenConcurrentlyUnsafe", SIG_FUNC(SIG_CLASS("com/lambda/event/listener/SafeListener"), SIG_CLASS("java/lang/Object") SIG_INT SIG_BOOLEAN SIG_CLASS("kotlinx/coroutines/CoroutineDispatcher") SIG_CLASS("kotlin/jvm/functions/Function2")));

    return companion;
}

inline
proxy*
    get_proxy(JNIEnv *env)
{
    proxy *p = malloc(sizeof(proxy));

    p->klass                = (*env)->FindClass(env, "java/lang/reflect/Proxy");
    p->new_proxy_instance   = (*env)->GetStaticMethodID(env, p->klass, "newProxyInstance", "(Ljava/lang/ClassLoader;[Ljava/lang/Class;Ljava/lang/reflect/InvocationHandler;)Ljava/lang/Object;");

    return p;
}

inline
event*
    get_event(jvmtiEnv *jvmti, JNIEnv *env, const char *name)
{
    event *e = malloc(sizeof(event));
    e->klass = (*env)->FindClass(env, name);
    e->instance = get_sclass(jvmti, env, e->klass);

    return e;
}

inline
jobject
    get_sclass(
        jvmtiEnv        *jvmti,
        JNIEnv          *env,
        const jclass    klass)
{
    char *sig;
    (*jvmti)->GetClassSignature(jvmti, klass, &sig, NULL);


    jfieldID staticField =
        (*env)->GetStaticFieldID(env, klass, "INSTANCE", sig);
    assert(NULL != staticField);

    jobject instance = (*env)->GetStaticObjectField(env, klass, staticField);
    assert(NULL != instance);

    return instance;
}

inline
jobject
    get_cclass(
        jvmtiEnv    *jvmti,
        JNIEnv      *env,
        jclass      super_klass,
        jclass      klass)
{
    char *sig = NULL;
    (*jvmti)->GetClassSignature(jvmti, klass, &sig, NULL);

    jfieldID staticField =
        (*env)->GetStaticFieldID(env, super_klass, "Companion", sig);

    return (*env)->GetStaticObjectField(env, klass, staticField);
}

inline
kotlin_reflection*
    get_kotlin_reflection(JNIEnv *env)
{
    kotlin_reflection *reflection = malloc(sizeof(kotlin_reflection));

    reflection->klass = (*env)->FindClass(env, "kotlin/jvm/internal/Reflection");
    reflection->get_kotlin_class =
        (*env)->GetStaticMethodID(env, reflection->klass, "getOrCreateKotlinClass", SIG_FUNC(SIG_CLASS("kotlin/reflect/KClass"), SIG_CLASS("java/lang/Class")));

    return reflection;
}

inline
const lambda*
    get_lambda(
        jvmtiEnv    *jvmti,
        JNIEnv      *env)
{
    lambda *l = malloc(sizeof(lambda));

    l->klass        = (*env)->FindClass(env, "com/lambda/Lambda");
    l->instance     = get_sclass(jvmti, env, l->klass);
    l->version      = (*env)->GetMethodID(env, l->klass, "getVERSION", SIG_FUNC(SIG_CLASS("java/lang/String")));
    l->log          = (*env)->GetMethodID(env, l->klass, "getLOG", SIG_FUNC(SIG_CLASS("org/apache/logging/log4j/Logger")));
    l->mc           = (*env)->GetStaticMethodID(env, l->klass, "getMc", SIG_FUNC(SIG_CLASS("net/minecraft/client/MinecraftClient")));
    l->is_debug     = (*env)->GetMethodID(env, l->klass, "isDebug", SIG_FUNC(SIG_BOOLEAN));

    return l;
}

inline
const char*
    lambda_version(
        JNIEnv          *env,
        const lambda    *lambda)
{
    const jstring ret = (*env)->CallObjectMethod(env, lambda->instance, lambda->version);
    return (*env)->GetStringUTFChars(env, ret, 0);
}

inline
jobject
    lambda_log(
        JNIEnv          *env,
        const lambda    *lambda)
{
    return (*env)->CallObjectMethod(env, lambda->instance, lambda->log);
}

inline
void*
    lambda_mc(
    JNIEnv          *env,
    const lambda    *lambda)
{
    return (*env)->CallStaticObjectMethod(env, lambda->instance, lambda->mc);
}

inline
jboolean
    lambda_is_debug(
        JNIEnv          *env,
        const lambda    *lambda)
{
    return (*env)->CallBooleanMethod(env, lambda->instance, lambda->is_debug);
}

uint8_t get_num(char c) {
    return c >= 'A' && c <= 'F' ? c - 'A' + 10 : c - '0';
}

uint8_t	to_byte(char c1, char c2) {
    return (get_num(c1) << 4 | get_num(c2));
}

const int8_t*
    define_function0(const char *suffix)
{
    const char *prefix = "com/lambda/Function0Native";
    size_t suffix_len = strlen(suffix);
    assert(suffix_len <= 128);

    char *class_name = malloc(26 + suffix_len);
    memcpy(class_name, prefix, 26);
    memcpy(class_name+26, suffix, suffix_len);


    int8_t *part1 = malloc(13 + 26 + suffix_len);
    int8_t n1[] = {0xca,0xfe,0xba,0xbe,0x00,0x00,0x00,0x41,0x00,0x24,0x01,0x00,(int8_t)suffix_len};
    memcpy(part1, n1, 13);
    memcpy(part1+13, class_name, 26 + suffix_len);

    int8_t n2[] = {0x07,0x00,0x01,0x01,0x00,0x10,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x07,0x00,0x03,0x01,0x00,0x1e,0x6b,0x6f,0x74,0x6c,0x69,0x6e,0x2f,0x6a,0x76,0x6d,0x2f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x73,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x07,0x00,0x05,0x01,0x00,0x23,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x48,0x61,0x6e,0x64,0x6c,0x65,0x72,0x07,0x00,0x07,0x01,0x00,0x14,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x4e,0x61,0x74,0x69,0x76,0x65,0x2e,0x6a,0x61,0x76,0x61,0x01,0x00,0x06,0x3c,0x69,0x6e,0x69,0x74,0x3e,0x01,0x00,0x03,0x28,0x29,0x56,0x0c,0x00,0x0a,0x00,0x0b,0x0a,0x00,0x04,0x00,0x0c,0x01,0x00,0x04,0x74,0x68,0x69,0x73,0x01,0x00,0x1c,0x4c,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x4e,0x61,0x74,0x69,0x76,0x65,0x3b,0x01,0x00,0x0c,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x4e,0x61,0x74,0x69,0x76,0x65,0x01,0x00,0x14,0x28,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x06,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x0c,0x00,0x10,0x00,0x11,0x0a,0x00,0x02,0x00,0x13,0x01,0x00,0x53,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x13,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x54,0x68,0x72,0x6f,0x77,0x61,0x62,0x6c,0x65,0x07,0x00,0x16,0x01,0x00,0x01,0x6f,0x01,0x00,0x06,0x6d,0x65,0x74,0x68,0x6f,0x64,0x01,0x00,0x07,0x6f,0x62,0x6a,0x65,0x63,0x74,0x73,0x01,0x00,0x12,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x1a,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x01,0x00,0x13,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x04,0x43,0x6f,0x64,0x65,0x01,0x00,0x0f,0x4c,0x69,0x6e,0x65,0x4e,0x75,0x6d,0x62,0x65,0x72,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x12,0x4c,0x6f,0x63,0x61,0x6c,0x56,0x61,0x72,0x69,0x61,0x62,0x6c,0x65,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x0a,0x45,0x78,0x63,0x65,0x70,0x74,0x69,0x6f,0x6e,0x73,0x01,0x00,0x10,0x4d,0x65,0x74,0x68,0x6f,0x64,0x50,0x61,0x72,0x61,0x6d,0x65,0x74,0x65,0x72,0x73,0x01,0x00,0x0a,0x53,0x6f,0x75,0x72,0x63,0x65,0x46,0x69,0x6c,0x65,0x00,0x21,0x00,0x02,0x00,0x04,0x00,0x02,0x00,0x06,0x00,0x08,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x0a,0x00,0x0b,0x00,0x01,0x00,0x1e,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb7,0x00,0x0d,0xb1,0x00,0x00,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x19,0x00,0x20,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x01,0x01,0x00,0x10,0x00,0x11,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x11,0x00,0x01,0x00,0x1e,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb6,0x00,0x14,0xb0,0x00,0x00,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x1d,0x00,0x20,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x15,0x00,0x03,0x00,0x1e,0x00,0x00,0x00,0x4d,0x00,0x01,0x00,0x04,0x00,0x00,0x00,0x05,0x2a,0xb6,0x00,0x14,0xb0,0x00,0x00,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x05,0x00,0x18,0x00,0x1b,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x19,0x00,0x1c,0x00,0x02,0x00,0x00,0x00,0x05,0x00,0x1a,0x00,0x1d,0x00,0x03,0x00,0x21,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x17,0x00,0x22,0x00,0x00,0x00,0x0d,0x03,0x00,0x18,0x00,0x00,0x00,0x19,0x00,0x00,0x00,0x1a,0x00,0x00,0x00,0x01,0x00,0x23,0x00,0x00,0x00,0x02,0x00,0x09};

    int8_t *class_file = malloc(13 + 26 + suffix_len + ARRAY_LEN(n2));
    memcpy(class_file, part1, 13+26+suffix_len);
    memcpy(class_file+13+26+suffix_len, n2, ARRAY_LEN(n2));

    free(part1);
    free(class_name);

    return class_file;
}

inline
void
    lambdah_init(
        jvmtiEnv    *jvmti,
        JNIEnv      *env)
{
    event *tickevent_pre = get_event(jvmti, env, "com/lambda/event/events/TickEvent$Pre");
    event *tickevent_post = get_event(jvmti, env, "com/lambda/event/events/TickEvent$Post");

    const kotlin_reflection *reflection = get_kotlin_reflection(env);
    const listener_companion *listener_companion_instance = get_listener_companion(jvmti, env);

    // FunctionN<Any>
    const int8_t function0_native_bytes[] = {0xca,0xfe,0xba,0xbe,0x00,0x00,0x00,0x41,0x00,0x24,0x01,0x00,0x1a,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x4e,0x61,0x74,0x69,0x76,0x65,0x07,0x00,0x01,0x01,0x00,0x10,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x07,0x00,0x03,0x01,0x00,0x1e,0x6b,0x6f,0x74,0x6c,0x69,0x6e,0x2f,0x6a,0x76,0x6d,0x2f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x73,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x07,0x00,0x05,0x01,0x00,0x23,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x48,0x61,0x6e,0x64,0x6c,0x65,0x72,0x07,0x00,0x07,0x01,0x00,0x14,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x4e,0x61,0x74,0x69,0x76,0x65,0x2e,0x6a,0x61,0x76,0x61,0x01,0x00,0x06,0x3c,0x69,0x6e,0x69,0x74,0x3e,0x01,0x00,0x03,0x28,0x29,0x56,0x0c,0x00,0x0a,0x00,0x0b,0x0a,0x00,0x04,0x00,0x0c,0x01,0x00,0x04,0x74,0x68,0x69,0x73,0x01,0x00,0x1c,0x4c,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x30,0x4e,0x61,0x74,0x69,0x76,0x65,0x3b,0x01,0x00,0x0c,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x4e,0x61,0x74,0x69,0x76,0x65,0x01,0x00,0x14,0x28,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x06,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x0c,0x00,0x10,0x00,0x11,0x0a,0x00,0x02,0x00,0x13,0x01,0x00,0x53,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x13,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x54,0x68,0x72,0x6f,0x77,0x61,0x62,0x6c,0x65,0x07,0x00,0x16,0x01,0x00,0x01,0x6f,0x01,0x00,0x06,0x6d,0x65,0x74,0x68,0x6f,0x64,0x01,0x00,0x07,0x6f,0x62,0x6a,0x65,0x63,0x74,0x73,0x01,0x00,0x12,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x1a,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x01,0x00,0x13,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x04,0x43,0x6f,0x64,0x65,0x01,0x00,0x0f,0x4c,0x69,0x6e,0x65,0x4e,0x75,0x6d,0x62,0x65,0x72,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x12,0x4c,0x6f,0x63,0x61,0x6c,0x56,0x61,0x72,0x69,0x61,0x62,0x6c,0x65,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x0a,0x45,0x78,0x63,0x65,0x70,0x74,0x69,0x6f,0x6e,0x73,0x01,0x00,0x10,0x4d,0x65,0x74,0x68,0x6f,0x64,0x50,0x61,0x72,0x61,0x6d,0x65,0x74,0x65,0x72,0x73,0x01,0x00,0x0a,0x53,0x6f,0x75,0x72,0x63,0x65,0x46,0x69,0x6c,0x65,0x00,0x21,0x00,0x02,0x00,0x04,0x00,0x02,0x00,0x06,0x00,0x08,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x0a,0x00,0x0b,0x00,0x01,0x00,0x1e,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb7,0x00,0x0d,0xb1,0x00,0x00,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x19,0x00,0x20,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x01,0x01,0x00,0x10,0x00,0x11,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x11,0x00,0x01,0x00,0x1e,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb6,0x00,0x14,0xb0,0x00,0x00,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x1d,0x00,0x20,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x15,0x00,0x03,0x00,0x1e,0x00,0x00,0x00,0x4d,0x00,0x01,0x00,0x04,0x00,0x00,0x00,0x05,0x2a,0xb6,0x00,0x14,0xb0,0x00,0x00,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x20,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x05,0x00,0x18,0x00,0x1b,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x19,0x00,0x1c,0x00,0x02,0x00,0x00,0x00,0x05,0x00,0x1a,0x00,0x1d,0x00,0x03,0x00,0x21,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x17,0x00,0x22,0x00,0x00,0x00,0x0d,0x03,0x00,0x18,0x00,0x00,0x00,0x19,0x00,0x00,0x00,0x1a,0x00,0x00,0x00,0x01,0x00,0x23,0x00,0x00,0x00,0x02,0x00,0x09};
    const int8_t function1_native_bytes[] = {0xca,0xfe,0xba,0xbe,0x00,0x00,0x00,0x41,0x00,0x25,0x01,0x00,0x1a,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x31,0x4e,0x61,0x74,0x69,0x76,0x65,0x07,0x00,0x01,0x01,0x00,0x10,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x07,0x00,0x03,0x01,0x00,0x1e,0x6b,0x6f,0x74,0x6c,0x69,0x6e,0x2f,0x6a,0x76,0x6d,0x2f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x73,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x31,0x07,0x00,0x05,0x01,0x00,0x23,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x48,0x61,0x6e,0x64,0x6c,0x65,0x72,0x07,0x00,0x07,0x01,0x00,0x14,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x31,0x4e,0x61,0x74,0x69,0x76,0x65,0x2e,0x6a,0x61,0x76,0x61,0x01,0x00,0x06,0x3c,0x69,0x6e,0x69,0x74,0x3e,0x01,0x00,0x03,0x28,0x29,0x56,0x0c,0x00,0x0a,0x00,0x0b,0x0a,0x00,0x04,0x00,0x0c,0x01,0x00,0x04,0x74,0x68,0x69,0x73,0x01,0x00,0x1c,0x4c,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x31,0x4e,0x61,0x74,0x69,0x76,0x65,0x3b,0x01,0x00,0x0c,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x4e,0x61,0x74,0x69,0x76,0x65,0x01,0x00,0x26,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x06,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x01,0x00,0x02,0x70,0x31,0x0c,0x00,0x10,0x00,0x11,0x0a,0x00,0x02,0x00,0x14,0x01,0x00,0x12,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x53,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x13,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x54,0x68,0x72,0x6f,0x77,0x61,0x62,0x6c,0x65,0x07,0x00,0x18,0x01,0x00,0x01,0x6f,0x01,0x00,0x06,0x6d,0x65,0x74,0x68,0x6f,0x64,0x01,0x00,0x07,0x6f,0x62,0x6a,0x65,0x63,0x74,0x73,0x01,0x00,0x1a,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x01,0x00,0x13,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x04,0x43,0x6f,0x64,0x65,0x01,0x00,0x0f,0x4c,0x69,0x6e,0x65,0x4e,0x75,0x6d,0x62,0x65,0x72,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x12,0x4c,0x6f,0x63,0x61,0x6c,0x56,0x61,0x72,0x69,0x61,0x62,0x6c,0x65,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x10,0x4d,0x65,0x74,0x68,0x6f,0x64,0x50,0x61,0x72,0x61,0x6d,0x65,0x74,0x65,0x72,0x73,0x01,0x00,0x0a,0x45,0x78,0x63,0x65,0x70,0x74,0x69,0x6f,0x6e,0x73,0x01,0x00,0x0a,0x53,0x6f,0x75,0x72,0x63,0x65,0x46,0x69,0x6c,0x65,0x00,0x21,0x00,0x02,0x00,0x04,0x00,0x02,0x00,0x06,0x00,0x08,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x0a,0x00,0x0b,0x00,0x01,0x00,0x1f,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb7,0x00,0x0d,0xb1,0x00,0x00,0x00,0x02,0x00,0x20,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x19,0x00,0x21,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x01,0x01,0x00,0x10,0x00,0x11,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x11,0x00,0x02,0x00,0x1f,0x00,0x00,0x00,0x3a,0x00,0x02,0x00,0x02,0x00,0x00,0x00,0x06,0x2a,0x2b,0xb6,0x00,0x15,0xb0,0x00,0x00,0x00,0x02,0x00,0x20,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x1d,0x00,0x21,0x00,0x00,0x00,0x16,0x00,0x02,0x00,0x00,0x00,0x06,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x06,0x00,0x13,0x00,0x16,0x00,0x01,0x00,0x22,0x00,0x00,0x00,0x05,0x01,0x00,0x13,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x17,0x00,0x03,0x00,0x1f,0x00,0x00,0x00,0x50,0x00,0x03,0x00,0x04,0x00,0x00,0x00,0x08,0x2a,0x2d,0x03,0x32,0xb6,0x00,0x15,0xb0,0x00,0x00,0x00,0x02,0x00,0x20,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x21,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x08,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x1a,0x00,0x16,0x00,0x01,0x00,0x00,0x00,0x08,0x00,0x1b,0x00,0x1d,0x00,0x02,0x00,0x00,0x00,0x08,0x00,0x1c,0x00,0x1e,0x00,0x03,0x00,0x23,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x19,0x00,0x22,0x00,0x00,0x00,0x0d,0x03,0x00,0x1a,0x00,0x00,0x00,0x1b,0x00,0x00,0x00,0x1c,0x00,0x00,0x00,0x01,0x00,0x24,0x00,0x00,0x00,0x02,0x00,0x09};
    const int8_t function2_native_bytes[] = {0xca,0xfe,0xba,0xbe,0x00,0x00,0x00,0x41,0x00,0x26,0x01,0x00,0x1a,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x32,0x4e,0x61,0x74,0x69,0x76,0x65,0x07,0x00,0x01,0x01,0x00,0x10,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x07,0x00,0x03,0x01,0x00,0x1e,0x6b,0x6f,0x74,0x6c,0x69,0x6e,0x2f,0x6a,0x76,0x6d,0x2f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x73,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x32,0x07,0x00,0x05,0x01,0x00,0x23,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x48,0x61,0x6e,0x64,0x6c,0x65,0x72,0x07,0x00,0x07,0x01,0x00,0x14,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x32,0x4e,0x61,0x74,0x69,0x76,0x65,0x2e,0x6a,0x61,0x76,0x61,0x01,0x00,0x06,0x3c,0x69,0x6e,0x69,0x74,0x3e,0x01,0x00,0x03,0x28,0x29,0x56,0x0c,0x00,0x0a,0x00,0x0b,0x0a,0x00,0x04,0x00,0x0c,0x01,0x00,0x04,0x74,0x68,0x69,0x73,0x01,0x00,0x1c,0x4c,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x32,0x4e,0x61,0x74,0x69,0x76,0x65,0x3b,0x01,0x00,0x0c,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x4e,0x61,0x74,0x69,0x76,0x65,0x01,0x00,0x38,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x06,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x01,0x00,0x02,0x70,0x31,0x01,0x00,0x02,0x70,0x32,0x0c,0x00,0x10,0x00,0x11,0x0a,0x00,0x02,0x00,0x15,0x01,0x00,0x12,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x53,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x13,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x54,0x68,0x72,0x6f,0x77,0x61,0x62,0x6c,0x65,0x07,0x00,0x19,0x01,0x00,0x01,0x6f,0x01,0x00,0x06,0x6d,0x65,0x74,0x68,0x6f,0x64,0x01,0x00,0x07,0x6f,0x62,0x6a,0x65,0x63,0x74,0x73,0x01,0x00,0x1a,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x01,0x00,0x13,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x04,0x43,0x6f,0x64,0x65,0x01,0x00,0x0f,0x4c,0x69,0x6e,0x65,0x4e,0x75,0x6d,0x62,0x65,0x72,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x12,0x4c,0x6f,0x63,0x61,0x6c,0x56,0x61,0x72,0x69,0x61,0x62,0x6c,0x65,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x10,0x4d,0x65,0x74,0x68,0x6f,0x64,0x50,0x61,0x72,0x61,0x6d,0x65,0x74,0x65,0x72,0x73,0x01,0x00,0x0a,0x45,0x78,0x63,0x65,0x70,0x74,0x69,0x6f,0x6e,0x73,0x01,0x00,0x0a,0x53,0x6f,0x75,0x72,0x63,0x65,0x46,0x69,0x6c,0x65,0x00,0x21,0x00,0x02,0x00,0x04,0x00,0x02,0x00,0x06,0x00,0x08,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x0a,0x00,0x0b,0x00,0x01,0x00,0x20,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb7,0x00,0x0d,0xb1,0x00,0x00,0x00,0x02,0x00,0x21,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x19,0x00,0x22,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x01,0x01,0x00,0x10,0x00,0x11,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x11,0x00,0x02,0x00,0x20,0x00,0x00,0x00,0x45,0x00,0x03,0x00,0x03,0x00,0x00,0x00,0x07,0x2a,0x2b,0x2c,0xb6,0x00,0x16,0xb0,0x00,0x00,0x00,0x02,0x00,0x21,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x1d,0x00,0x22,0x00,0x00,0x00,0x20,0x00,0x03,0x00,0x00,0x00,0x07,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x07,0x00,0x13,0x00,0x17,0x00,0x01,0x00,0x00,0x00,0x07,0x00,0x14,0x00,0x17,0x00,0x02,0x00,0x23,0x00,0x00,0x00,0x09,0x02,0x00,0x13,0x00,0x00,0x00,0x14,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x18,0x00,0x03,0x00,0x20,0x00,0x00,0x00,0x53,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x0b,0x2a,0x2d,0x03,0x32,0x2d,0x04,0x32,0xb6,0x00,0x16,0xb0,0x00,0x00,0x00,0x02,0x00,0x21,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x22,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x0b,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x0b,0x00,0x1b,0x00,0x17,0x00,0x01,0x00,0x00,0x00,0x0b,0x00,0x1c,0x00,0x1e,0x00,0x02,0x00,0x00,0x00,0x0b,0x00,0x1d,0x00,0x1f,0x00,0x03,0x00,0x24,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x1a,0x00,0x23,0x00,0x00,0x00,0x0d,0x03,0x00,0x1b,0x00,0x00,0x00,0x1c,0x00,0x00,0x00,0x1d,0x00,0x00,0x00,0x01,0x00,0x25,0x00,0x00,0x00,0x02,0x00,0x09};
    const int8_t function3_native_bytes[] = {0xca,0xfe,0xba,0xbe,0x00,0x00,0x00,0x41,0x00,0x27,0x01,0x00,0x1a,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x33,0x4e,0x61,0x74,0x69,0x76,0x65,0x07,0x00,0x01,0x01,0x00,0x10,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x07,0x00,0x03,0x01,0x00,0x1e,0x6b,0x6f,0x74,0x6c,0x69,0x6e,0x2f,0x6a,0x76,0x6d,0x2f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x73,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x33,0x07,0x00,0x05,0x01,0x00,0x23,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x48,0x61,0x6e,0x64,0x6c,0x65,0x72,0x07,0x00,0x07,0x01,0x00,0x14,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x33,0x4e,0x61,0x74,0x69,0x76,0x65,0x2e,0x6a,0x61,0x76,0x61,0x01,0x00,0x06,0x3c,0x69,0x6e,0x69,0x74,0x3e,0x01,0x00,0x03,0x28,0x29,0x56,0x0c,0x00,0x0a,0x00,0x0b,0x0a,0x00,0x04,0x00,0x0c,0x01,0x00,0x04,0x74,0x68,0x69,0x73,0x01,0x00,0x1c,0x4c,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x33,0x4e,0x61,0x74,0x69,0x76,0x65,0x3b,0x01,0x00,0x0c,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x4e,0x61,0x74,0x69,0x76,0x65,0x01,0x00,0x4a,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x06,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x01,0x00,0x02,0x70,0x31,0x01,0x00,0x02,0x70,0x32,0x01,0x00,0x02,0x70,0x33,0x0c,0x00,0x10,0x00,0x11,0x0a,0x00,0x02,0x00,0x16,0x01,0x00,0x12,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x53,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x13,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x54,0x68,0x72,0x6f,0x77,0x61,0x62,0x6c,0x65,0x07,0x00,0x1a,0x01,0x00,0x01,0x6f,0x01,0x00,0x06,0x6d,0x65,0x74,0x68,0x6f,0x64,0x01,0x00,0x07,0x6f,0x62,0x6a,0x65,0x63,0x74,0x73,0x01,0x00,0x1a,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x01,0x00,0x13,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x04,0x43,0x6f,0x64,0x65,0x01,0x00,0x0f,0x4c,0x69,0x6e,0x65,0x4e,0x75,0x6d,0x62,0x65,0x72,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x12,0x4c,0x6f,0x63,0x61,0x6c,0x56,0x61,0x72,0x69,0x61,0x62,0x6c,0x65,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x10,0x4d,0x65,0x74,0x68,0x6f,0x64,0x50,0x61,0x72,0x61,0x6d,0x65,0x74,0x65,0x72,0x73,0x01,0x00,0x0a,0x45,0x78,0x63,0x65,0x70,0x74,0x69,0x6f,0x6e,0x73,0x01,0x00,0x0a,0x53,0x6f,0x75,0x72,0x63,0x65,0x46,0x69,0x6c,0x65,0x00,0x21,0x00,0x02,0x00,0x04,0x00,0x02,0x00,0x06,0x00,0x08,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x0a,0x00,0x0b,0x00,0x01,0x00,0x21,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb7,0x00,0x0d,0xb1,0x00,0x00,0x00,0x02,0x00,0x22,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x19,0x00,0x23,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x01,0x01,0x00,0x10,0x00,0x11,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x11,0x00,0x02,0x00,0x21,0x00,0x00,0x00,0x50,0x00,0x04,0x00,0x04,0x00,0x00,0x00,0x08,0x2a,0x2b,0x2c,0x2d,0xb6,0x00,0x17,0xb0,0x00,0x00,0x00,0x02,0x00,0x22,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x1d,0x00,0x23,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x08,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x13,0x00,0x18,0x00,0x01,0x00,0x00,0x00,0x08,0x00,0x14,0x00,0x18,0x00,0x02,0x00,0x00,0x00,0x08,0x00,0x15,0x00,0x18,0x00,0x03,0x00,0x24,0x00,0x00,0x00,0x0d,0x03,0x00,0x13,0x00,0x00,0x00,0x14,0x00,0x00,0x00,0x15,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x19,0x00,0x03,0x00,0x21,0x00,0x00,0x00,0x56,0x00,0x05,0x00,0x04,0x00,0x00,0x00,0x0e,0x2a,0x2d,0x03,0x32,0x2d,0x04,0x32,0x2d,0x05,0x32,0xb6,0x00,0x17,0xb0,0x00,0x00,0x00,0x02,0x00,0x22,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x23,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x0e,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x0e,0x00,0x1c,0x00,0x18,0x00,0x01,0x00,0x00,0x00,0x0e,0x00,0x1d,0x00,0x1f,0x00,0x02,0x00,0x00,0x00,0x0e,0x00,0x1e,0x00,0x20,0x00,0x03,0x00,0x25,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x1b,0x00,0x24,0x00,0x00,0x00,0x0d,0x03,0x00,0x1c,0x00,0x00,0x00,0x1d,0x00,0x00,0x00,0x1e,0x00,0x00,0x00,0x01,0x00,0x26,0x00,0x00,0x00,0x02,0x00,0x09};
    const int8_t function4_native_bytes[] = {0xca,0xfe,0xba,0xbe,0x00,0x00,0x00,0x41,0x00,0x28,0x01,0x00,0x1a,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x34,0x4e,0x61,0x74,0x69,0x76,0x65,0x07,0x00,0x01,0x01,0x00,0x10,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x07,0x00,0x03,0x01,0x00,0x1e,0x6b,0x6f,0x74,0x6c,0x69,0x6e,0x2f,0x6a,0x76,0x6d,0x2f,0x66,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x73,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x34,0x07,0x00,0x05,0x01,0x00,0x23,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x49,0x6e,0x76,0x6f,0x63,0x61,0x74,0x69,0x6f,0x6e,0x48,0x61,0x6e,0x64,0x6c,0x65,0x72,0x07,0x00,0x07,0x01,0x00,0x14,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x34,0x4e,0x61,0x74,0x69,0x76,0x65,0x2e,0x6a,0x61,0x76,0x61,0x01,0x00,0x06,0x3c,0x69,0x6e,0x69,0x74,0x3e,0x01,0x00,0x03,0x28,0x29,0x56,0x0c,0x00,0x0a,0x00,0x0b,0x0a,0x00,0x04,0x00,0x0c,0x01,0x00,0x04,0x74,0x68,0x69,0x73,0x01,0x00,0x1c,0x4c,0x63,0x6f,0x6d,0x2f,0x6c,0x61,0x6d,0x62,0x64,0x61,0x2f,0x46,0x75,0x6e,0x63,0x74,0x69,0x6f,0x6e,0x34,0x4e,0x61,0x74,0x69,0x76,0x65,0x3b,0x01,0x00,0x0c,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x4e,0x61,0x74,0x69,0x76,0x65,0x01,0x00,0x5c,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x06,0x69,0x6e,0x76,0x6f,0x6b,0x65,0x01,0x00,0x02,0x70,0x31,0x01,0x00,0x02,0x70,0x32,0x01,0x00,0x02,0x70,0x33,0x01,0x00,0x02,0x70,0x34,0x0c,0x00,0x10,0x00,0x11,0x0a,0x00,0x02,0x00,0x17,0x01,0x00,0x12,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x53,0x28,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x29,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x13,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x54,0x68,0x72,0x6f,0x77,0x61,0x62,0x6c,0x65,0x07,0x00,0x1b,0x01,0x00,0x01,0x6f,0x01,0x00,0x06,0x6d,0x65,0x74,0x68,0x6f,0x64,0x01,0x00,0x07,0x6f,0x62,0x6a,0x65,0x63,0x74,0x73,0x01,0x00,0x1a,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x72,0x65,0x66,0x6c,0x65,0x63,0x74,0x2f,0x4d,0x65,0x74,0x68,0x6f,0x64,0x3b,0x01,0x00,0x13,0x5b,0x4c,0x6a,0x61,0x76,0x61,0x2f,0x6c,0x61,0x6e,0x67,0x2f,0x4f,0x62,0x6a,0x65,0x63,0x74,0x3b,0x01,0x00,0x04,0x43,0x6f,0x64,0x65,0x01,0x00,0x0f,0x4c,0x69,0x6e,0x65,0x4e,0x75,0x6d,0x62,0x65,0x72,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x12,0x4c,0x6f,0x63,0x61,0x6c,0x56,0x61,0x72,0x69,0x61,0x62,0x6c,0x65,0x54,0x61,0x62,0x6c,0x65,0x01,0x00,0x10,0x4d,0x65,0x74,0x68,0x6f,0x64,0x50,0x61,0x72,0x61,0x6d,0x65,0x74,0x65,0x72,0x73,0x01,0x00,0x0a,0x45,0x78,0x63,0x65,0x70,0x74,0x69,0x6f,0x6e,0x73,0x01,0x00,0x0a,0x53,0x6f,0x75,0x72,0x63,0x65,0x46,0x69,0x6c,0x65,0x00,0x21,0x00,0x02,0x00,0x04,0x00,0x02,0x00,0x06,0x00,0x08,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x0a,0x00,0x0b,0x00,0x01,0x00,0x22,0x00,0x00,0x00,0x2f,0x00,0x01,0x00,0x01,0x00,0x00,0x00,0x05,0x2a,0xb7,0x00,0x0d,0xb1,0x00,0x00,0x00,0x02,0x00,0x23,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x19,0x00,0x24,0x00,0x00,0x00,0x0c,0x00,0x01,0x00,0x00,0x00,0x05,0x00,0x0e,0x00,0x0f,0x00,0x00,0x01,0x01,0x00,0x10,0x00,0x11,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x11,0x00,0x02,0x00,0x22,0x00,0x00,0x00,0x5c,0x00,0x05,0x00,0x05,0x00,0x00,0x00,0x0a,0x2a,0x2b,0x2c,0x2d,0x19,0x04,0xb6,0x00,0x18,0xb0,0x00,0x00,0x00,0x02,0x00,0x23,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x1d,0x00,0x24,0x00,0x00,0x00,0x34,0x00,0x05,0x00,0x00,0x00,0x0a,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x0a,0x00,0x13,0x00,0x19,0x00,0x01,0x00,0x00,0x00,0x0a,0x00,0x14,0x00,0x19,0x00,0x02,0x00,0x00,0x00,0x0a,0x00,0x15,0x00,0x19,0x00,0x03,0x00,0x00,0x00,0x0a,0x00,0x16,0x00,0x19,0x00,0x04,0x00,0x25,0x00,0x00,0x00,0x11,0x04,0x00,0x13,0x00,0x00,0x00,0x14,0x00,0x00,0x00,0x15,0x00,0x00,0x00,0x16,0x00,0x00,0x00,0x01,0x00,0x12,0x00,0x1a,0x00,0x03,0x00,0x22,0x00,0x00,0x00,0x59,0x00,0x06,0x00,0x04,0x00,0x00,0x00,0x11,0x2a,0x2d,0x03,0x32,0x2d,0x04,0x32,0x2d,0x05,0x32,0x2d,0x07,0x32,0xb6,0x00,0x18,0xb0,0x00,0x00,0x00,0x02,0x00,0x23,0x00,0x00,0x00,0x06,0x00,0x01,0x00,0x00,0x00,0x20,0x00,0x24,0x00,0x00,0x00,0x2a,0x00,0x04,0x00,0x00,0x00,0x11,0x00,0x0e,0x00,0x0f,0x00,0x00,0x00,0x00,0x00,0x11,0x00,0x1d,0x00,0x19,0x00,0x01,0x00,0x00,0x00,0x11,0x00,0x1e,0x00,0x20,0x00,0x02,0x00,0x00,0x00,0x11,0x00,0x1f,0x00,0x21,0x00,0x03,0x00,0x26,0x00,0x00,0x00,0x04,0x00,0x01,0x00,0x1c,0x00,0x25,0x00,0x00,0x00,0x0d,0x03,0x00,0x1d,0x00,0x00,0x00,0x1e,0x00,0x00,0x00,0x1f,0x00,0x00,0x00,0x01,0x00,0x27,0x00,0x00,0x00,0x02,0x00,0x09};

    const jclass thread_klass =             (*env)->FindClass(env, "java/lang/Thread");
    jmethodID current_thread_method =       (*env)->GetStaticMethodID(env, thread_klass, "currentThread", SIG_FUNC(SIG_CLASS("java/lang/Thread")));
    jmethodID get_context_classloader =     (*env)->GetMethodID(env, thread_klass, "getContextClassLoader", SIG_FUNC(SIG_CLASS("java/lang/ClassLoader")));
    jobject thread_instance =               (*env)->CallStaticObjectMethod(env, thread_klass, current_thread_method);
    jobject class_loader =                  (*env)->CallObjectMethod(env, thread_instance, get_context_classloader);

    /*const int8_t *cc = define_function0("$transfem");
    (*env)->DefineClass(env, "com/lambda/Function0Native$transfem", class_loader, cc, sizeof(cc) / sizeof(cc[0]));*/

    (*env)->DefineClass(env, "com/lambda/Function0Native", class_loader, function0_native_bytes, ARRAY_LEN(function0_native_bytes));
    (*env)->DefineClass(env, "com/lambda/Function1Native", class_loader, function1_native_bytes, ARRAY_LEN(function1_native_bytes));
    (*env)->DefineClass(env, "com/lambda/Function2Native", class_loader, function2_native_bytes, ARRAY_LEN(function2_native_bytes));
    (*env)->DefineClass(env, "com/lambda/Function3Native", class_loader, function3_native_bytes, ARRAY_LEN(function3_native_bytes));
    (*env)->DefineClass(env, "com/lambda/Function4Native", class_loader, function4_native_bytes, ARRAY_LEN(function4_native_bytes));

    const jclass function0 = (*env)->FindClass(env, "kotlin/jvm/functions/Function0");
    const jclass function1 = (*env)->FindClass(env, "kotlin/jvm/functions/Function1");
    const jclass function2 = (*env)->FindClass(env, "kotlin/jvm/functions/Function2");
    const jclass function3 = (*env)->FindClass(env, "kotlin/jvm/functions/Function3");
    const jclass function4 = (*env)->FindClass(env, "kotlin/jvm/functions/Function4");
    const jclass function0_native = (*env)->FindClass(env, "com/lambda/Function0Native");
    const jclass function1_native = (*env)->FindClass(env, "com/lambda/Function1Native");
    const jclass function2_native = (*env)->FindClass(env, "com/lambda/Function2Native");
    const jclass function3_native = (*env)->FindClass(env, "com/lambda/Function3Native");
    const jclass function4_native = (*env)->FindClass(env, "com/lambda/Function4Native");

    const jclass class = (*env)->FindClass(env, "java/lang/Class");
    jobjectArray function0_interfaces = (*env)->NewObjectArray(env, 1, class, function0);
    jobjectArray function1_interfaces = (*env)->NewObjectArray(env, 1, class, function1);
    jobjectArray function2_interfaces = (*env)->NewObjectArray(env, 1, class, function2);
    jobjectArray function3_interfaces = (*env)->NewObjectArray(env, 1, class, function3);
    jobjectArray function4_interfaces = (*env)->NewObjectArray(env, 1, class, function4);

    jmethodID function0_native_init = (*env)->GetMethodID(env, function0_native, "<init>", SIG_FUNC(SIG_VOID));
    jmethodID function1_native_init = (*env)->GetMethodID(env, function1_native, "<init>", SIG_FUNC(SIG_VOID));
    jmethodID function2_native_init = (*env)->GetMethodID(env, function2_native, "<init>", SIG_FUNC(SIG_VOID));
    jmethodID function3_native_init = (*env)->GetMethodID(env, function3_native, "<init>", SIG_FUNC(SIG_VOID));
    jmethodID function4_native_init = (*env)->GetMethodID(env, function4_native, "<init>", SIG_FUNC(SIG_VOID));

    jobject function0_native_instance = (*env)->NewObject(env, function0_native, function0_native_init);
    jobject function1_native_instance = (*env)->NewObject(env, function1_native, function1_native_init);
    jobject function2_native_instance = (*env)->NewObject(env, function2_native, function2_native_init);
    jobject function3_native_instance = (*env)->NewObject(env, function3_native, function3_native_init);
    jobject function4_native_instance = (*env)->NewObject(env, function4_native, function4_native_init);

    jclass proxy_klass = (*env)->FindClass(env, "java/lang/reflect/Proxy");
    jmethodID new_proxy_instance = (*env)->GetStaticMethodID(env, proxy_klass, "newProxyInstance", "(Ljava/lang/ClassLoader;[Ljava/lang/Class;Ljava/lang/reflect/InvocationHandler;)Ljava/lang/Object;");

    // jdk.proxy2.$Proxy33
    jobject proxy_function0_native = (*env)->CallStaticObjectMethod(env, proxy_klass, new_proxy_instance, class_loader, function0_interfaces, function0_native_instance);
    jobject proxy_function1_native = (*env)->CallStaticObjectMethod(env, proxy_klass, new_proxy_instance, class_loader, function1_interfaces, function1_native_instance);
    jobject proxy_function2_native = (*env)->CallStaticObjectMethod(env, proxy_klass, new_proxy_instance, class_loader, function2_interfaces, function2_native_instance);
    jobject proxy_function3_native = (*env)->CallStaticObjectMethod(env, proxy_klass, new_proxy_instance, class_loader, function3_interfaces, function3_native_instance);
    jobject proxy_function4_native = (*env)->CallStaticObjectMethod(env, proxy_klass, new_proxy_instance, class_loader, function4_interfaces, function4_native_instance);

    jclass kotlin_native = (*env)->CallStaticObjectMethod(env, reflection->klass, reflection->get_kotlin_class, tickevent_pre->klass);

    (*env)->CallObjectMethod(env,
        listener_companion_instance->klass,
        listener_companion_instance->listen_k,
        proxy_function2_native,
        kotlin_native,
        1,
        0,
        proxy_function2_native);
}

inline
JNIEXPORT
jobject
JNICALL
  Java_com_lambda_Function2Native_invokeNative(
      JNIEnv    *env,
      jobject   p1,
      jobject   p2)
{
    fprintf(stderr, "TICKEVENT FROM JVMTI !!!\n");
    return 0;
}

#endif
#endif
